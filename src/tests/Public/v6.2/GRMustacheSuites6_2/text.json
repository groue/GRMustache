{
  "tests": [
    {
      "name": "RENDER:HTML pragma has no particular effect",
      "data": { "subject" : "&" },
      "template": "{{% RENDER:HTML }}[{{subject}}{{{subject}}}]",
      "expected": "[&amp;&]"
    },
    {
      "name": "RENDER:TEXT pragma disables HTML-escaping",
      "data": { "subject" : "&" },
      "template": "{{% RENDER:TEXT }}[{{subject}}{{{subject}}}]",
      "expected": "[&&]"
    },
    {
      "name": "RENDER:HTML pragma following RENDER:TEXT pragma enables HTML-escaping",
      "data": { "subject" : "&" },
      "template": "{{% RENDER:TEXT }}{{% RENDER:HTML }}[{{subject}}{{{subject}}}]",
      "expected": "[&amp;&]"
    },
    {
      "name": "RENDER:TEXT pragma following RENDER:HTML pragma disables HTML-escaping",
      "data": { "subject" : "&" },
      "template": "{{% RENDER:HTML }}{{% RENDER:TEXT }}[{{subject}}{{{subject}}}]",
      "expected": "[&&]"
    },
    {
      "name": "RENDER:TEXT pragma can follow text",
      "data": { "subject" : "&" },
      "template": "hey {{% RENDER:TEXT }}[{{subject}}{{{subject}}}]",
      "expected": "hey [&&]"
    },
    {
      "name": "RENDER:TEXT pragma can follow comment",
      "data": { "subject" : "&" },
      "template": "{{! a text template }}{{% RENDER:TEXT }}[{{subject}}{{{subject}}}]",
      "expected": "[&&]"
    },
    {
      "name": "RENDER:TEXT pragma can follow set delimiters tag",
      "data": { "subject" : "&" },
      "template": "{{=< >=}}<% RENDER:TEXT >[<subject><&subject>]",
      "expected": "[&&]"
    },
    {
      "name": "RENDER:TEXT pragma can not follow variable tag.",
      "data": null,
      "template": "{{subject}}{{% RENDER:TEXT }}",
      "expected_error": "Parse error"
    },
    {
      "name": "RENDER:TEXT pragma can not follow section tag.",
      "data": null,
      "template": "{{#foo}}{{/foo}}{{% RENDER:TEXT }}",
      "expected_error": "Parse error"
    },
    {
      "name": "RENDER:TEXT pragma can not follow inverted section tag.",
      "data": null,
      "template": "{{^foo}}{{/foo}}{{% RENDER:TEXT }}",
      "expected_error": "Parse error"
    },
    {
      "name": "RENDER:TEXT pragma can not follow overridable section tag.",
      "data": null,
      "template": "{{$foo}}{{/foo}}{{% RENDER:TEXT }}",
      "expected_error": "Parse error"
    },
    {
      "name": "RENDER:TEXT pragma can not enter section tag.",
      "data": null,
      "template": "{{#foo}}{{% RENDER:TEXT }}{{/foo}}",
      "expected_error": "Parse error"
    },
    {
      "name": "RENDER:TEXT pragma can not enter inverted section tag.",
      "data": null,
      "template": "{{^foo}}{{% RENDER:TEXT }}{{/foo}}",
      "expected_error": "Parse error"
    },
    {
      "name": "RENDER:TEXT pragma can not enter overridable section tag.",
      "data": null,
      "template": "{{$foo}}{{% RENDER:TEXT }}{{/foo}}",
      "expected_error": "Parse error"
    },
    {
      "name": "RENDER:TEXT pragma can not follow partial tag.",
      "data": null,
      "template": "{{>partial}}{{% RENDER:TEXT }}",
      "partials": { "partial": "" },
      "expected_error": "Parse error"
    },
    {
      "name": "RENDER:TEXT pragma can not enter overridable partial tag.",
      "data": null,
      "template": "{{<layout}}{{% RENDER:TEXT }}{{/layout}}",
      "partials": { "layout": "{{% RENDER:TEXT }}{{$content}}{{/content}}" },
      "expected_error": "Parse error"
    },
    {
      "name": "Partial containing RENDER:TEXT pragma is HTML-escaped when embedded.",
      "data": { "subject" : "&" },
      "template": "{{>partial}}",
      "partials": { "partial": "{{% RENDER:TEXT }}[{{subject}}{{{subject}}}]" },
      "expected": "[&amp;&amp;]"
    },
    {
      "name": "Template containing RENDER:TEXT pragma does not process HTML partials.",
      "data": { "subject" : "&" },
      "template": "{{% RENDER:TEXT }}{{>partial}}",
      "partials": { "partial": "[{{subject}}{{{subject}}}]" },
      "expected": "[&amp;&]"
    },
    {
      "name": "HTML template can override HTML template",
      "data": { "subject" : "&" },
      "template": "{{<layout}}{{$content}}[{{subject}}{{{subject}}}]{{/content}}{{/layout}}",
      "partials": { "layout": "{{$content}}{{/content}}" },
      "expected": "[&amp;&]"
    },
    {
      "name": "TEXT template can override TEXT template",
      "data": { "subject" : "&" },
      "template": "{{% RENDER:TEXT }}{{<layout}}{{$content}}[{{subject}}{{{subject}}}]{{/content}}{{/layout}}",
      "partials": { "layout": "{{% RENDER:TEXT }}{{$content}}{{/content}}" },
      "expected": "[&&]"
    },
    {
      "name": "HTML template can not override TEXT template",
      "data": null,
      "template": "{{<layout}}{{/layout}}",
      "partials": { "layout": "{{% RENDER:TEXT }}" },
      "expected_error": "Parse error"
    },
    {
      "name": "TEXT template can not override HTML template",
      "data": null,
      "template": "{{% RENDER:TEXT }}{{<layout}}{{/layout}}",
      "partials": { "layout": "" },
      "expected_error": "Parse error"
    }
  ]
}
